App As appinfo:
    BackEnabled: =false
    OnStart: |
        =Set(cargando, true);
        
        //////////////////////////////////LLAMADOS A FLUJOS//////////////////////////////////////
        
        //USUARIO LOGEADO
        //Set(persona_solicitante; 'VRIM-PATraedatosdeusuario'.Run(User().Email));;
        Set(persona_solicitante, 'VRIM-PATraedatosdeusuario'.Run("melissa@udec.cl"));
        
        //LISTAS DESPLEGABLES
        Set(datos,'DTI-PAListaespecificacionesconvenio'.Run());
        
        //LISTADO SOLICITUDES
        ClearCollect(listado_solicitudes, Sort('Convenios-PATraerlistadodesolicitud'.Run(persona_solicitante.correo_udec), fecha));
        
        
        //nombres reparticiones
        Set(reparticiones, 'DTI-PATraerreparticiones'.Run());
        Clear(Nombres_reparticiones);
        ForAll(reparticiones,
            Collect(Nombres_reparticiones,{
                reparticion: Nombre1,
                codigo: Title
            })
        );
        ClearCollect(Nombres_reparticiones,Sort(Nombres_reparticiones,reparticion));
        
        //autoridades máximas
        Set(autoridades_maximas,'DTI-PATraerautoridadesmáximas'.Run());
        Clear(Nombres_autoridades);
        ForAll(autoridades_maximas,
            Collect(Nombres_autoridades,{
                nombre: Concatenate(field_3," ",field_4,", ",field_5),
                cargo: CARGO,
                correo: CORREO_UDEC,
                telefono: TELEFONO
            })
        );
        ClearCollect(Nombres_autoridades, Sort(Nombres_autoridades,nombre));
        
        Set(cargando, false);
        
        //////////////////////////////////COMPLETAR VARIABLES Y COLECCIONES//////////////////////////////////////
        
        //UNIDAD SOLICITANTE
        ClearCollect(organismos_actividad, 
                SortByColumns(persona_solicitante.'array organismo actividad',"Reparticion"));
        
        //ALCANCE TERRITORIAL
        Clear(lista_alcance);
        ForAll(datos.alcance_territorial,
            Collect(lista_alcance,{
                id: ItemInternalId,
                valor: Title
            })
        );
        ClearCollect(lista_alcance,Sort(lista_alcance,valor));
        
        //TIPOLOGÍA
        Clear(lista_tipologia);
        ForAll(datos.tipologia,
            Collect(lista_tipologia,{
                id: ItemInternalId,
                valor: Title
            })
        );
        ClearCollect(lista_tipologia,Sort(lista_tipologia,valor));
        
        //TIPO SOLICITUD
        Clear(lista_tipo_solicitud);
        ForAll(datos.tipo_solicitud,
            Collect(lista_tipo_solicitud,{
                id: ItemInternalId,
                valor: Title
            })
        );
        ClearCollect(lista_tipo_solicitud,Sort(lista_tipo_solicitud,valor));
        
        //MODALIDAD
        Clear(lista_modalidad);
        ForAll(datos.modalidad,
            Collect(lista_modalidad,{
                id: ItemInternalId,
                valor: Title
            })
        );
        ClearCollect(lista_modalidad,Sort(lista_modalidad,valor));
        
        //NACIONALES
        Clear(contrapartes_nacionales);
        
        //INTERNACIONALES
        Clear(contrapartes_internacionales);
        
        //SOLICITUDES AÑADIR CONTRAPARTE
        Clear(solicitudes_añadir_contraparte);
        
        //nombres contrapartes internacionales
        Set(Contrapartes_inter,'DTI-PATraernombrescontrapartesinternacionales'.Run());
        Clear(Nombres_contrapartes_internacionales);
        ForAll(Contrapartes_inter,
            Collect(Nombres_contrapartes_internacionales,{
                nombre: RAZON_SOCIAL
            })
        );
        ClearCollect(Nombres_contrapartes_internacionales, Sort(Nombres_contrapartes_internacionales,nombre));
        
        //paises
        Set(paises,Sort('DTI-PATraerpaíses'.Run().paises,Nombre_x0020_Pa_x00ed_s));
        Clear(lista_paises);
        
        ForAll(paises,
            Collect(lista_paises,{
                pais: Upper(ThisRecord.Nombre_x0020_Pa_x00ed_s)
            })
        );
        
        Remove(lista_paises, LookUp( lista_paises, pais="NO DEFINIDO" ));
        
        //opciones seleccionables política del convenio
        ClearCollect(dd_tipo,
            {
                valor: "Formación (pregrado, postgrado, formación permanente)",
                id: "formacion"
            },
            {
                valor: "Extensión Académica",
                id: "extension_academica"
            },
            {
                valor: "Extensión Cultural",
                id: "extension_cultural"
            },
            {
                valor: "Bidireccional",
                id: "bidireccional"
            },
            {
                valor: "Otra",
                id: "otra"
            }
        );
        
        ClearCollect(dd_sectores,
            {
                valor: "Público - Político",
                id: "publico_politico"
            },
            {
                valor: "Social Comunitario",
                id: "social_comunitario"
            },
            {
                valor: "Cultural",
                id: "cultural"
            },
            {
                valor: "Productivo",
                id: "productivo"
            },
            {
                valor: "Comunidad Universitaria",
                id: "comunidad_uni"
            }
        );
        
        ClearCollect(dd_ambito,
            {
                valor: "Extensión",
                id: "extension"
            },
            {
                valor: "Comunicaciones",
                id: "comunicaciones"
            },
            {
                valor: "Emprendimiento",
                id: "emprendimiento"
            },
            {
                valor: "Transferencia tecnológica",
                id: "transferencia_tecnologica"
            },
            {
                valor: "Asistencia técnica",
                id: "asistencia_tecnica"
            },
            {
                valor: "Interacción con red alumni",
                id: "red_alumni"
            },
            {
                valor: "Relaciones institucionales",
                id: "rel_institucionales"
            },
            {
                valor: "Relaciones internacionales",
                id: "rel_internacionales"
            },
            {
                valor: "Prácticas profesionales, pasantías estudiantiles y académicas",
                id: "practicas_pasantia"
            },
            {
                valor: "Servicios",
                id: "servicios"
            }
        );

    Host As hostControl.DefaultHostControlVariant:
        OnCancel: =false
        OnEdit: =false
        OnNew: =false
        OnSave: =false
        OnView: =false

