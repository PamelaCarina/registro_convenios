Mostar_solicitudes As screen:
    Fill: =RGBA(235, 238, 251, 1)
    OnVisible: |+
        =///////////////////////////REINICIAR VALORES DE PARÁMETROS///////////////////////////16-06-2023
        /*
        Set(reset_primera_vez_especificacion;true);;
        Set(reset_primera_vez_categoria_vrim;true);;
        Set(reset_primera_vez_area_contribucion;true);;
        Set(reset_primera_vez_ods;true);;
        */
        
        Set(guardado,false);
        
        //PANTALLA - UNIDAD SOLICITANTE
        Set(solicitud_convenio_recuperada,Blank());
        Set(unidad_solicitante_recuperada,Blank());
        Set(autoridad,Blank());
        Set(responsable,Blank());
        Clear(unidades_promotoras);
        Clear(id_unidades_promotoras);
        Reset(nombre_unidad_solicitante);
        Reset(tipo_alcance);
        
        //PANTALLA - ENTIDAD CONTRAPARTE
        Set(tab_seleccionada,1);
        Set(contraparte_na,Blank());
        Set(contraparte_in,Blank());
        Clear(contrapartes_nacionales);
        Clear(id_contrapartes_nacionales);
        Clear(contrapartes_internacionales);
        Clear(id_contrapartes_internacionales);
        Clear(solicitudes_añadir_contraparte);
        Clear(id_solicitudes_añadir_contraparte);
        Clear(lista_doc_contr_subidos);
        
        //PANTALLA - DATOS CONVENIO
        Reset(tipo_tipologia);
        Reset(tipo_solicitud);
        Reset(tipo_modalidades);
        Set(especificacion_convenio_recuperada,Blank());
        Set(convenio_existente_seleccionado,Blank());
        Clear(lista_doc_off_subidos);
        Clear(id_lista_doc_off_subidos);
        Clear(lista_doc_ext_subidos);
        Clear(id_lista_doc_ext_subidos);
        Reset(descripcion_proposito_1);
        
        //PANTALLA - INFORMACIÓN CONVENIO
        Reset(convenio_tipo);
        Reset(sector_politica);
        Reset(ambito_politica);
        Set(categoria_vrim_recuperada,Blank());
        
        //PANTALLA - ÁREA CONTRIBUCIÓN
        Reset(cb_formacion_pregrado);
        Reset(cb_formacion_postgrado);
        Reset(cb_formacion_investigacion);
        Reset(cb_formacion_permanente);
        Reset(cb_desarrollo_ambiental);
        Reset(cb_desarrollo_productivo);
        Reset(cb_desarrollo_social);
        Reset(cb_educacion);
        Reset(cb_inclusion);
        Reset(cb_salud);
        Reset(cb_sector_publico);
        Reset(cb_patrimonio);
        Reset(cb_desarrollo_cultural);
        Reset(cb_interculturalidad);
        Set(area_contribucion_recuperada,Blank());
        
        //PANTALLA - CONTRIBUCIÓN DESARROLLO
        Reset(cb_ods_1);Reset(cb_ods_2);Reset(cb_ods_3);Reset(cb_ods_4);Reset(cb_ods_5);
        Reset(cb_ods_6);Reset(cb_ods_7);Reset(cb_ods_8);Reset(cb_ods_5);Reset(cb_ods_6);
        Reset(cb_ods_7);Reset(cb_ods_8);Reset(cb_ods_9);Reset(cb_ods_10);Reset(cb_ods_11);
        Reset(cb_ods_12);Reset(cb_ods_13);Reset(cb_ods_14);Reset(cb_ods_15);Reset(cb_ods_16);
        Reset(cb_ods_17);Reset(cb_ods_ninguno);
        Set(ods_recuperada,Blank());
        
        //////////////////////////////////////////////////////////////////////////////////////
        
        
        //para pruebas con auditoria
        ClearCollect(log_auditoria,{
            fecha_modif: "14-07-2023",
            Actividad: "nombre actividad",
            Estado: "estado x",
            operacion_modif: "operacion x",
            usuario_modif:"usuario x"
        })
        
        

    Botones_atras_siguiente_8 As groupContainer.manualLayoutContainer:
        Height: =44
        Width: =1286
        X: =40
        Y: =696
        ZIndex: =1

        Siguiente_8 As button:
            Fill: =RGBA(247, 158, 64, 1)
            FontWeight: =FontWeight.Bold
            HoverBorderColor: =RGBA(247, 158, 64, 1)
            HoverFill: =RGBA(247, 158, 64, 0.4)
            OnSelect: |+
                =Set(id_convenio,Blank());
                Set(id_estado,1);
                Set(nuevo,true);
                Reset(nombre_unidad_solicitante);
                Reset(tipo_alcance);
                
                Navigate(Unidad_solicitante,ScreenTransition.Fade);
                
            PressedBorderColor: =RGBA(247, 158, 64, 1)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(249, 133, 11, 1)
            RadiusBottomLeft: =12
            RadiusBottomRight: =12
            RadiusTopLeft: =12
            RadiusTopRight: =12
            Size: =14
            TabIndex: =1
            Text: ="NUEVA"
            X: =1124
            Y: =2
            ZIndex: =1

    mostrar_solicitudes As groupContainer.manualLayoutContainer:
        Height: =488
        Width: =1282
        X: =40
        Y: =190
        ZIndex: =2

        Container2 As groupContainer.manualLayoutContainer:
            Height: =336
            Width: =1282
            Y: =152
            ZIndex: =1

            img_bgk_listado_main As image:
                Height: =320
                Image: ='background-section'
                ImagePosition: =ImagePosition.Fill
                RadiusBottomLeft: =24
                RadiusBottomRight: =24
                RadiusTopLeft: =24
                RadiusTopRight: =24
                Width: =1282
                Y: =16
                ZIndex: =1

            lbl_alcance As label:
                Color: =RGBA(17, 61, 107, 1)
                FontWeight: =FontWeight.Bold
                Height: =38
                Text: ="Alcance territorial"
                Width: =200
                X: =608
                Y: =44
                ZIndex: =2

            lbl_fecha As label:
                Color: =RGBA(17, 61, 107, 1)
                FontWeight: =FontWeight.Bold
                Height: =38
                Text: ="Última modificación"
                Width: =200
                X: =51
                Y: =44
                ZIndex: =3

            lbl_contraparte_asociada As label:
                Color: =RGBA(17, 61, 107, 1)
                FontWeight: =FontWeight.Bold
                Height: =38
                Text: ="Primera contraparte asociada"
                Width: =300
                X: =275
                Y: =44
                ZIndex: =4

            "gal_listado_solicitudes As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
                FocusedBorderColor: |-
                    =ColorValue("#6F8BA7")
                FocusedBorderThickness: =0
                Height: =226
                Items: |-
                    =Search(
                        listado_solicitudes_recuperadas,
                        inp_search.Text,
                        "nombre_contraparte_para_filtro"    
                    )
                    /*
                    Search(
                        listado_solicitudes;
                        inp_search.Text;
                        "alcance_territorial"    
                    )
                    Clear(nombre_contraparte_para_filtro);;
                    Clear(listado_solicitudes_recuperadas);;
                    */
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =80
                Width: =1198
                X: =42
                Y: =82
                ZIndex: =5

                fig_separador_main As rectangle:
                    Fill: =RGBA(112, 139, 166, 1)
                    Height: =1
                    OnSelect: =Select(Parent)
                    Width: =1160
                    Y: =Parent.TemplateHeight - 1
                    ZIndex: =1

                img_arrow As image:
                    Height: =80
                    Image: =ico_arrow
                    OnSelect: |-
                        =Select(Parent);
                        Set(nueva_solicitud, false);
                    Visible: =false
                    Width: =14
                    X: =1146
                    ZIndex: =2

                btn_detalle As button:
                    BorderStyle: =BorderStyle.None
                    DisabledFill: =RGBA(0, 0, 0, 0)
                    Fill: =RGBA(0, 0, 0, 0)
                    FocusedBorderColor: |-
                        =ColorValue("#6F8BA7")
                    FocusedBorderThickness: =2
                    Height: =80
                    HoverFill: =RGBA(0, 0, 0, 0)
                    OnSelect: |+
                        =Set(id_convenio,ThisItem.id_convenio);
                        Set(id_estado,ThisItem.id_estado);
                        Set(nuevo,false);
                        
                        Set(cargando,true);
                        
                        Set(solicitud_convenio_recuperada,
                            'Convenio-PATraerestadosolicitudporpantalla'.Run(
                                                                        id_convenio
                            )
                        );
                        
                        Set(unidad_solicitante_recuperada,solicitud_convenio_recuperada.unidad_solicitante_registrada);
                        
                        Set(autoridad,{
                            nombre: unidad_solicitante_recuperada.nombre_autoridad,
                            cargo: unidad_solicitante_recuperada.cargo_autoridad,
                            correo: unidad_solicitante_recuperada.correo_autoridad,
                            telefono: unidad_solicitante_recuperada.telefono_autoridad
                        });
                        
                        Set(responsable,{
                            id_persona: "",
                            nombre: unidad_solicitante_recuperada.nombre_responsable,
                            cargo: unidad_solicitante_recuperada.cargo_responsable,
                            correo: unidad_solicitante_recuperada.correo_responsable,
                            telefono: unidad_solicitante_recuperada.telefono_responsable
                        });
                        
                        Set(cargando,false);
                        
                        ForAll(unidad_solicitante_recuperada.unidades_promotoras,
                            Collect(unidades_promotoras,{
                                id_unidad_promotora:id_unidad_promotora,
                                nombre_unidad_promotora: reparticion,
                                codigo_reparticion: codigo_reparticion
                            });
                            Collect(id_unidades_promotoras,{ID:id_unidad_promotora})
                        );
                        
                        ForAll(solicitud_convenio_recuperada.contrapartes_nacionales,
                            Collect(contrapartes_nacionales,{
                                nombre_entidad_contraparte: nombre_entidad_contraparte,
                                rut_entidad_contraparte: rut_entidad_contraparte,
                                dv_entidad_contraparte: dv_entidad_contraparte,
                                nombre_representante_legal: nombre_representante_legal,
                                nombre_responsable_institucional: nombre_responsable_institucional,
                                cargo_responsable_institucional: cargo_responsable_institucional,
                                correo_responsable_institucional: correo_responsable_institucional,
                                publica: publica,
                                tipo_empresa: tipo_empresa,
                                comuna: comuna,
                                tipo_contribuyente: tipo_contribuyente,
                                rubro: rubro,
                                actividad: actividad,
                                id: id,
                                firma_digital: firma_digital
                            });
                            Collect(id_contrapartes_nacionales,{ID: id})
                        );
                        
                        ForAll(solicitud_convenio_recuperada.contrapartes_internacionales,
                            Collect(contrapartes_internacionales,{
                                nombre_entidad_contraparte: nombre_entidad_contraparte,
                                nombre_representante_legal: nombre_representante_legal,
                                nombre_responsable_institucional: nombre_responsable_institucional,
                                cargo_responsable_institucional: cargo_responsable_institucional,
                                pais: pais,
                                correo_responsable_institucional: correo_responsable_institucional,
                                id: id,
                                firma_digital: firma_digital
                            });
                            Collect(id_contrapartes_internacionales,{ID: id})
                        );
                        
                        ForAll(solicitud_convenio_recuperada.solicitudes_contraparte_internacional,
                            Collect(solicitudes_añadir_contraparte,{
                                id_contraparte: id,
                                nombre: nombre_entidad_contraparte,
                                pais: pais,
                                estado: estado,
                                file: file
                            });
                            Collect(id_solicitudes_añadir_contraparte,{ID: id})
                        );
                        
                        Set(especificacion_convenio_recuperada,solicitud_convenio_recuperada.especificacion_registrada);
                        
                        ForAll(especificacion_convenio_recuperada.borrador_convenio,
                            Collect(lista_doc_off_subidos,{
                                file:file
                            });
                            Collect(id_lista_doc_off_subidos,{
                                ID:id
                            })
                        );
                        
                        ForAll(especificacion_convenio_recuperada.documentos_extra,
                            Collect(lista_doc_ext_subidos,{
                                file:file
                            });
                            Collect(id_lista_doc_ext_subidos,{
                                ID:id
                            })
                        );
                        
                        Set(categoria_vrim_recuperada,solicitud_convenio_recuperada.categoria_vrim_registrada);
                        
                        Set(area_contribucion_recuperada,solicitud_convenio_recuperada.area_contribucion_registrada);
                        
                        Set(ods_recuperada,solicitud_convenio_recuperada.ods_registrada);
                        
                        //If(ThisItem.estado<>"Registrada";Navigate(Unidad_solicitante;ScreenTransition.Fade));;
                        Set(tab_seleccionada,1);
                        
                        Navigate(Unidad_solicitante,ScreenTransition.Fade);
                        
                        If(IsBlank(unidad_solicitante_recuperada.nombre_unidad_solicitante),Reset(nombre_unidad_solicitante));
                        If(IsBlank(unidad_solicitante_recuperada.alcance_territorial),Reset(tipo_alcance));
                        
                        
                        
                        
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    PressedColor: =RGBA(0, 0, 0, 0)
                    PressedFill: =RGBA(0, 0, 0, 0)
                    TabIndex: =3
                    Text: =""
                    Visible: =false
                    Width: =14
                    X: =1146
                    ZIndex: =3

                btn_historial As icon.More:
                    Height: =30
                    Icon: =Icon.More
                    OnSelect: |
                        =Set(IDconvenio, ThisItem.id_convenio);
                        Set(IDestado, ThisItem.id_estado);
                        UpdateContext({menu_opciones:true});
                    Width: =44
                    X: =1102
                    Y: =21
                    ZIndex: =4

                lbl_gal_contraparte As label:
                    Color: =RGBA(17, 61, 107, 1)
                    Height: =80
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =12
                    PaddingRight: =12
                    PaddingTop: =0
                    Size: =13
                    Text: |-
                        =//If(ThisItem.estado="Registrada";ThisItem.estado;"Solicitud incompleta")
                        //Index(ThisItem.nombres_contrapartes_nacionales; 1).Value
                        //Index(ThisItem.nombres_contrapartes_internacionales, 1).Value
                        
                        /*If(Len(Index(ThisItem.nombres_contrapartes_internacionales, 1).Value) = 0,
                        Index(ThisItem.nombres_contrapartes_nacionales, 1).Value,
                        Index(ThisItem.nombres_contrapartes_internacionales, 1).Value
                        );*/
                        
                        If(CountRows(ThisItem.nombres_contrapartes_internacionales)>0,
                            If(CountRows(ThisItem.nombres_contrapartes_nacionales)>0,
                                //si hay contrapartes internacionales y nacionales
                                    First(ThisItem.nombres_contrapartes_internacionales).Value
                                    //"internacional si, nacional si"
                                ,
                                //si hay contrapartes internacionales y no nacionales
                                    First(ThisItem.nombres_contrapartes_internacionales).Value
                                    //"internacional si, nacional no"
                            ),
                            If(CountRows(ThisItem.nombres_contrapartes_nacionales)>0,
                                //si no hay contrapartes internacionales y pero si nacionales
                                    First(ThisItem.nombres_contrapartes_nacionales).Value
                                    //"internacional no, nacional si"
                                ,
                                //si no hay contrapartes internacionales ni nacionales
                                    "SIN CONTRAPARTES ASOCIADAS"
                            )
                        )
                    Width: =290
                    X: =228
                    ZIndex: =5

                lbl_gal_fecha As label:
                    Color: =RGBA(17, 61, 107, 1)
                    FontWeight: =FontWeight.Normal
                    Height: =80
                    OnSelect: =Select(Parent)
                    Size: =13
                    Text: |+
                        =DateTimeValue(ThisItem.fecha)
                        
                    Width: =180
                    X: =10
                    ZIndex: =6

                lbl_gal_alcance As label:
                    Color: =RGBA(17, 61, 107, 1)
                    Height: =80
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =12
                    PaddingRight: =12
                    PaddingTop: =0
                    Size: =13
                    Text: =Upper(ThisItem.alcance_territorial)
                    Width: =260
                    X: =558
                    ZIndex: =7

                lbl_gal_estado As label:
                    Color: =RGBA(17, 61, 107, 1)
                    Height: =80
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =12
                    PaddingRight: =12
                    PaddingTop: =0
                    Size: =13
                    Text: |-
                        =If(ThisItem.id_estado=13,
                            "SOLICITUD REGISTRADA",
                            If(ThisItem.id_estado=14,
                                "APROBADA POR LA AUTORIDAD",
                                If(ThisItem.id_estado=15,
                                    "RECHAZADA POR LA AUTORIDAD",
                                    "SOLICITUD INCOMPLETA"
                                )
                            )
                            //"SOLICITUD INCOMPLETA"
                        )
                    Width: =236
                    X: =850
                    ZIndex: =8

            lbl_estado_solicitud As label:
                Color: =RGBA(17, 61, 107, 1)
                FontWeight: =FontWeight.Bold
                Height: =38
                Text: ="Estado solicitud"
                Width: =200
                X: =898
                Y: =44
                ZIndex: =6

        buscar_solicitudes As groupContainer.manualLayoutContainer:
            Height: =127
            Width: =1281
            ZIndex: =2

            img_bgk_filter As image:
                Height: =126
                Image: ='background-section'
                ImagePosition: =ImagePosition.Fill
                RadiusBottomLeft: =24
                RadiusBottomRight: =24
                RadiusTopLeft: =24
                RadiusTopRight: =24
                Width: =1281
                ZIndex: =1

            inp_search As text:
                BorderColor: =RGBA(255, 255, 255, 1)
                BorderThickness: =0
                Color: =RGBA(17, 61, 107, 1)
                Default: =""
                DisabledColor: =RGBA(111, 139, 167, 1)
                Fill: =RGBA(241, 244, 255, 1)
                FocusedBorderColor: |-
                    =ColorValue("#6F8BA7")
                FocusedBorderThickness: =2
                HintText: ="Buscar primera contraparte asociada..."
                HoverBorderColor: =RGBA(255, 255, 255, 0)
                HoverFill: =RGBA(241, 244, 255, 1)
                MaxLength: =50
                PaddingBottom: =12
                PaddingLeft: =24
                PaddingTop: =12
                RadiusBottomLeft: =12
                RadiusBottomRight: =12
                RadiusTopLeft: =12
                RadiusTopRight: =12
                Size: =14
                TabIndex: =1
                Width: =976
                X: =35
                Y: =43
                ZIndex: =2

            img_search As image:
                Height: =20
                Image: =ico_search
                Width: =20
                X: =978
                Y: =53
                ZIndex: =3

            btn_refrescar As button:
                BorderThickness: =0
                Color: =RGBA(17, 61, 107, 1)
                Fill: =RGBA(0, 0, 0, 0)
                FontWeight: =FontWeight.Bold
                OnSelect: |-
                    =Set(cargando, true);
                    ClearCollect(listado_solicitudes, 
                            Sort('Convenios-PATraerlistadodesolicitud'.Run(persona_solicitante.correo_udec), fecha, SortOrder.Descending));
                            //MOSTRAR SOLICITUDES
                    Clear(nombre_contraparte_para_filtro);
                    Clear(listado_solicitudes_recuperadas);
                    ForAll(listado_solicitudes,
                    If(CountRows(nombres_contrapartes_internacionales)>0,
                        If(CountRows(nombres_contrapartes_nacionales)>0,
                            //si hay contrapartes internacionales y nacionales
                            Collect(nombre_contraparte_para_filtro,First(nombres_contrapartes_internacionales).Value)
                        ,
                            //si hay contrapartes internacionales y no nacionales
                            Collect(nombre_contraparte_para_filtro,First(nombres_contrapartes_internacionales).Value)
                        ),
                        If(CountRows(nombres_contrapartes_nacionales)>0,
                            //si no hay contrapartes internacionales y pero si nacionales
                            Collect(nombre_contraparte_para_filtro,First(nombres_contrapartes_nacionales).Value)
                            ,
                            //si no hay contrapartes internacionales ni nacionales
                            Collect(nombre_contraparte_para_filtro,"SIN CONTRAPARTES ASOCIADAS")
                                
                        )
                    );
                        Collect(listado_solicitudes_recuperadas,{
                            alcance_territorial:alcance_territorial,
                            fecha:fecha,
                            id_convenio:id_convenio,
                            id_estado:id_estado,
                            nombres_contrapartes_nacionales:nombres_contrapartes_nacionales,
                            nombres_contrapartes_internacionales:nombres_contrapartes_internacionales,
                            ticket:ticket,
                            nombre_contraparte_para_filtro:Last(nombre_contraparte_para_filtro).Value
                        })
                    );
                    Set(cargando, false);
                RadiusBottomLeft: =12
                RadiusBottomRight: =12
                RadiusTopLeft: =12
                RadiusTopRight: =12
                Size: =14
                Text: ="Refrescar información"
                Width: =223
                X: =1022
                Y: =43
                ZIndex: =6

    lbl_mostrar_solicitudes As label:
        Color: =RGBA(17, 61, 107, 1)
        FontWeight: =FontWeight.Bold
        Height: =96
        PaddingBottom: =34
        PaddingLeft: =42
        PaddingRight: =0
        PaddingTop: =42
        Size: =20
        Text: ="Listado de solicitudes de tramitación de convenios"
        Width: =1366
        Y: =100
        ZIndex: =3

    BannerUdeC_11 As HeaderUdeC:
        Bienvenido: =If(persona_solicitante.sexo_social="F","Bienvenida,","Bienvenido,")
        Subtitulo: ="VINCULACIÓN CON EL MEDIO"
        Titulo: ="Solicitud de Tramitación de Convenios"
        ZIndex: =4

    cont_menu_opciones_1 As groupContainer.manualLayoutContainer:
        Height: =768
        Visible: =menu_opciones
        Width: =1366
        ZIndex: =5

        Rectangle3_1 As rectangle:
            BorderColor: =RGBA(0, 0, 0, 0)
            Fill: =RGBA(0, 0, 0, 0)
            Height: =cont_menu_opciones_1.Height
            OnSelect: |-
                =UpdateContext({menu_opciones:false});
            Width: =cont_menu_opciones_1.Width
            ZIndex: =1

        menu_opciones_boxshadow_1 As htmlViewer:
            Fill: =RGBA(0, 0, 0, 0)
            Height: =158
            HtmlText: |-
                ="<div style='background-color:black; width:362px;height:175px; opacity:0.20; box-shadow: inset 0 0 8px 8px white'></div>"
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Width: =360
            X: =844
            Y: =462
            ZIndex: =2

        "menu_opciones_solicitud_1 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
            DelayItemLoading: =true
            Fill: =RGBA(255, 255, 255, 1)
            Height: =149
            Items: |-
                =Table({icon: Icon.View, text:"Ver detalles"},
                {icon: Icon.Edit, text:"Editar"},
                {icon: Icon.History, text:"Historial de modificaciones"})
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =50
            Width: =350
            X: =854
            Y: =468
            ZIndex: =4

            gal_menu_opciones_bg_1 As rectangle:
                BorderColor: =RGBA(0, 0, 0, 0)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =Parent.TemplateHeight
                HoverFill: =RGBA(241, 244, 255, 1)
                OnSelect: =Select(Parent)
                Width: =Parent.Width
                ZIndex: =1

            gal_menu_opciones_label_1 As label:
                BorderColor: =RGBA(17, 61, 107, 1)
                Color: =RGBA(17, 61, 107, 1)
                DisplayMode: |-
                    =/*
                    If(And(puede_editar=false;ThisItem.text="Editar");
                        DisplayMode.Disabled;
                        And(gal_solicitud_seleccionada.estado<>"Admisible";ThisItem.text="Emitir constancia");
                        DisplayMode.Disabled;
                        ThisItem.text="Historial de modificaciones";
                        DisplayMode.Disabled;
                        DisplayMode.Edit)
                    */
                    
                    If(And(id_estado>=13, ThisItem.text="Editar"),
                    DisplayMode.Disabled,
                    And(id_estado<13, ThisItem.text="Ver detalles"),
                    DisplayMode.Disabled)
                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                Height: =50
                HoverFill: =RGBA(241, 244, 255, 1)
                OnSelect: |-
                    =If(ThisItem.text="Historial de modificaciones",
                        Set(cargando,true);
                        /*ClearCollect(
                        listado_auditoria;
                        Sort(
                            'Convenio-PATraerdatosdeauditoría'.Run(IDconvenio);
                            fecha;
                            SortOrder.Descending
                        )
                        );;*/
                        Set(listado_auditoria,'Convenio-PATraerdatosdeauditoría'.Run(IDconvenio));
                        UpdateContext({popup_historial:true});
                        Set(cargando,false)
                    );
                    If(ThisItem.text="Ver detalles" || ThisItem.text="Editar",
                    Set(id_convenio,IDconvenio);
                    Set(id_estado,IDestado);
                    Set(nuevo,false);
                    
                    Set(cargando,true);
                    
                    Set(solicitud_convenio_recuperada,
                        'Convenio-PATraerestadosolicitudporpantalla'.Run(
                                                                    id_convenio
                        )
                    );
                    
                    Set(unidad_solicitante_recuperada,solicitud_convenio_recuperada.unidad_solicitante_registrada);
                    
                    Set(autoridad,{
                        nombre: unidad_solicitante_recuperada.nombre_autoridad,
                        cargo: unidad_solicitante_recuperada.cargo_autoridad,
                        correo: unidad_solicitante_recuperada.correo_autoridad,
                        telefono: unidad_solicitante_recuperada.telefono_autoridad
                    });
                    
                    Set(responsable,{
                        id_persona: "",
                        nombre: unidad_solicitante_recuperada.nombre_responsable,
                        cargo: unidad_solicitante_recuperada.cargo_responsable,
                        correo: unidad_solicitante_recuperada.correo_responsable,
                        telefono: unidad_solicitante_recuperada.telefono_responsable
                    });
                    
                    Set(cargando,false);
                    
                    ForAll(unidad_solicitante_recuperada.unidades_promotoras,
                        Collect(unidades_promotoras,{
                            id_unidad_promotora:id_unidad_promotora,
                            nombre_unidad_promotora: reparticion,
                            codigo_reparticion: codigo_reparticion
                        });
                        Collect(id_unidades_promotoras,{ID:id_unidad_promotora})
                    );
                    
                    ForAll(solicitud_convenio_recuperada.contrapartes_nacionales,
                        Collect(contrapartes_nacionales,{
                            nombre_entidad_contraparte: nombre_entidad_contraparte,
                            rut_entidad_contraparte: rut_entidad_contraparte,
                            dv_entidad_contraparte: dv_entidad_contraparte,
                            nombre_representante_legal: nombre_representante_legal,
                            nombre_responsable_institucional: nombre_responsable_institucional,
                            cargo_responsable_institucional: cargo_responsable_institucional,
                            correo_responsable_institucional: correo_responsable_institucional,
                            publica: publica,
                            tipo_empresa: tipo_empresa,
                            comuna: comuna,
                            tipo_contribuyente: tipo_contribuyente,
                            rubro: rubro,
                            actividad: actividad,
                            id: id,
                            firma_digital: firma_digital
                        });
                        Collect(id_contrapartes_nacionales,{ID: id})
                    );
                    
                    ForAll(solicitud_convenio_recuperada.contrapartes_internacionales,
                        Collect(contrapartes_internacionales,{
                            nombre_entidad_contraparte: nombre_entidad_contraparte,
                            nombre_representante_legal: nombre_representante_legal,
                            nombre_responsable_institucional: nombre_responsable_institucional,
                            cargo_responsable_institucional: cargo_responsable_institucional,
                            pais: pais,
                            correo_responsable_institucional: correo_responsable_institucional,
                            id: id,
                            firma_digital: firma_digital
                        });
                        Collect(id_contrapartes_internacionales,{ID: id})
                    );
                    
                    ForAll(solicitud_convenio_recuperada.solicitudes_contraparte_internacional,
                        Collect(solicitudes_añadir_contraparte,{
                            id_contraparte: id,
                            nombre: nombre_entidad_contraparte,
                            pais: pais,
                            estado: estado,
                            file: file
                        });
                        Collect(id_solicitudes_añadir_contraparte,{ID: id})
                    );
                    
                    Set(especificacion_convenio_recuperada,solicitud_convenio_recuperada.especificacion_registrada);
                    
                    ForAll(especificacion_convenio_recuperada.borrador_convenio,
                        Collect(lista_doc_off_subidos,{
                            file:file
                        });
                        Collect(id_lista_doc_off_subidos,{
                            ID:id
                        })
                    );
                    
                    ForAll(especificacion_convenio_recuperada.documentos_extra,
                        Collect(lista_doc_ext_subidos,{
                            file:file
                        });
                        Collect(id_lista_doc_ext_subidos,{
                            ID:id
                        })
                    );
                    
                    Set(categoria_vrim_recuperada,solicitud_convenio_recuperada.categoria_vrim_registrada);
                    
                    Set(area_contribucion_recuperada,solicitud_convenio_recuperada.area_contribucion_registrada);
                    
                    Set(ods_recuperada,solicitud_convenio_recuperada.ods_registrada);
                    
                    //If(ThisItem.estado<>"Registrada";Navigate(Unidad_solicitante;ScreenTransition.Fade));;
                    Set(tab_seleccionada,1);
                    
                    UpdateContext({menu_opciones:false});
                    Navigate(Unidad_solicitante,ScreenTransition.Fade);
                    
                    If(IsBlank(unidad_solicitante_recuperada.nombre_unidad_solicitante),Reset(nombre_unidad_solicitante));
                    If(IsBlank(unidad_solicitante_recuperada.alcance_territorial),Reset(tipo_alcance))
                    )
                PaddingBottom: =0
                PaddingLeft: =43
                PaddingRight: =0
                PaddingTop: =0
                Size: =12
                Text: =ThisItem.text
                Width: =Parent.Width
                ZIndex: =2

            gal_menu_opciones_icon_1 As icon.ChevronRight:
                AccessibleLabel: =Self.Tooltip
                Color: =RGBA(17, 61, 107, 1)
                DisabledColor: =RGBA(186, 186, 186, 1)
                DisplayMode: =gal_menu_opciones_label_1.DisplayMode
                Height: =40
                Icon: =ThisItem.icon
                OnSelect: =Select(gal_menu_opciones_label_1)
                PaddingBottom: =7
                PaddingLeft: =7
                PaddingRight: =7
                PaddingTop: =7
                Tooltip: ="View item details"
                Width: =40
                Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
                ZIndex: =3

    cont_registro_main_auditoria As groupContainer.manualLayoutContainer:
        Height: =768
        Visible: =popup_historial
        Width: =1366
        ZIndex: =6

        fig_registro_main_bg_4 As rectangle:
            BorderStyle: =BorderStyle.None
            Fill: =RGBA(0, 0, 0, 0.20)
            Height: =768
            Width: =1366
            ZIndex: =1

        img_registro_main_popup_bg_9 As image:
            Height: =600
            Image: ='background-section'
            ImagePosition: =ImagePosition.Fill
            RadiusBottomLeft: =24
            RadiusBottomRight: =24
            RadiusTopLeft: =24
            RadiusTopRight: =24
            Width: =1200
            X: =83
            Y: =84
            ZIndex: =2

        gal_main_auditoria As gallery.galleryVertical:
            DelayItemLoading: =true
            Height: =400
            Items: =listado_auditoria
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            OnSelect: =log_auditoria
            TemplatePadding: =0
            TemplateSize: =100
            Width: =1090
            X: =138
            Y: =234
            ZIndex: =3

            lbl_gal_auditoria_fecha As label:
                Color: =RGBA(17, 61, 107, 1)
                Height: =Parent.TemplateHeight
                Size: =12
                Text: |-
                    =//Text(ThisItem.fecha;"d/m/yyyy hh:mm:ss")
                    ThisItem.fecha
                Width: =96
                ZIndex: =1

            lbl_gal_auditoria_operacion As label:
                Color: =RGBA(17, 61, 107, 1)
                Height: =Parent.TemplateHeight
                Size: =12
                Text: =ThisItem.operacion_modif
                Width: =141
                X: =758
                ZIndex: =2

            lbl_gal_auditoria_actividad As label:
                Color: =RGBA(17, 61, 107, 1)
                Height: =Parent.TemplateHeight
                Size: =12
                Text: =
                Width: =257
                X: =112
                ZIndex: =3

            lbl_gal_auditoria_modificadopor As label:
                Color: =RGBA(17, 61, 107, 1)
                Height: =Parent.TemplateHeight
                Size: =12
                Text: =ThisItem.usuario_modif
                Width: =177
                X: =912
                ZIndex: =6

            fig_separador_main_1 As rectangle:
                Fill: =RGBA(112, 139, 166, 1)
                Height: =1
                OnSelect: =Select(Parent)
                Width: =Parent.TemplateWidth - 50   
                X: =15
                Y: =Parent.TemplateHeight - 1
                ZIndex: =7

            lbl_gal_auditoria_estado As label:
                Color: =RGBA(17, 61, 107, 1)
                Height: =Parent.TemplateHeight
                Size: =12
                Text: =
                Width: =166
                X: =573
                ZIndex: =9

            lbl_gal_auditoria_estado_1 As label:
                Color: =RGBA(17, 61, 107, 1)
                Height: =Parent.TemplateHeight
                Size: =12
                Text: =ThisItem.alcance_territorial
                Width: =162
                X: =384
                ZIndex: =10

        lbl_titulo_main_3 As label:
            Color: =RGBA(17, 61, 107, 1)
            FontWeight: =FontWeight.Bold
            Height: =96
            PaddingBottom: =34
            PaddingLeft: =42
            PaddingRight: =0
            PaddingTop: =42
            Size: =20
            Text: ="Historial de modificaciones"
            Width: =img_registro_main_popup_bg_9.Width
            X: =img_registro_main_popup_bg_9.X
            Y: =img_registro_main_popup_bg_9.Y
            ZIndex: =4

        icn_registro_main_popup_cerrar As icon.CancelBadge:
            Color: =RGBA(166, 166, 166, 1)
            Height: =30
            Icon: =Icon.Cancel
            Width: =30
            X: =img_registro_main_popup_bg_9.X+img_registro_main_popup_bg_9.Width-Self.Width-42
            Y: =img_registro_main_popup_bg_9.Y+30
            ZIndex: =5

        btn_registro_main_popup_cerrar As button:
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            Fill: =RGBA(0, 0, 0, 0)
            Height: =icn_registro_main_popup_cerrar.Height
            HoverFill: =Self.Fill
            OnSelect: |-
                =UpdateContext({popup_historial:false})
            Text: =""
            Width: =icn_registro_main_popup_cerrar.Width
            X: =icn_registro_main_popup_cerrar.X
            Y: =icn_registro_main_popup_cerrar.Y
            ZIndex: =6

        lbl_fecha_main_popup As label:
            Color: =RGBA(17, 61, 107, 1)
            FontWeight: =FontWeight.Bold
            Height: =38
            Text: ="Fecha"
            Width: =120
            X: =gal_main_auditoria.X
            Y: =gal_main_auditoria.Y-Self.Height-5
            ZIndex: =7

        lbl_operacion_main_popup As label:
            Color: =RGBA(17, 61, 107, 1)
            FontWeight: =FontWeight.Bold
            Height: =38
            Text: ="Operación"
            Width: =120
            X: =893
            Y: =191
            ZIndex: =8

        lbl_actividad_main_popup As label:
            Color: =RGBA(17, 61, 107, 1)
            FontWeight: =FontWeight.Bold
            Height: =20
            Text: ="Primera contraparte asociada"
            Width: =290
            X: =241
            Y: =200
            ZIndex: =9

        lbl_estado_main_popup As label:
            Color: =RGBA(17, 61, 107, 1)
            FontWeight: =FontWeight.Bold
            Height: =38
            Text: ="Estado solicitud"
            Width: =154
            X: =707
            Y: =191
            ZIndex: =10

        lbl_modificadopor_main_popup As label:
            Color: =RGBA(17, 61, 107, 1)
            FontWeight: =FontWeight.Bold
            Height: =38
            Text: ="Modificado por"
            Width: =180
            X: =gal_main_auditoria.X+180*5
            Y: =gal_main_auditoria.Y-Self.Height-5
            ZIndex: =12

        lbl_estado_main_popup_1 As label:
            Color: =RGBA(17, 61, 107, 1)
            FontWeight: =FontWeight.Bold
            Height: =38
            Text: ="Alcance territorial"
            Width: =171
            X: =517
            Y: =191
            ZIndex: =13

    grp_registro_main_loading As group:
        Height: =5
        Width: =5
        X: =60
        Y: =60
        ZIndex: =7

        fig_registro_5_bg_5 As rectangle:
            BorderStyle: =BorderStyle.None
            Fill: =RGBA(0, 0, 0, 0.20)
            Height: =768
            Visible: =cargando
            Width: =1366
            ZIndex: =7

        img_registro_5_loading_1 As image:
            Image: =loading
            Visible: =cargando
            X: =631
            Y: =384
            ZIndex: =8

